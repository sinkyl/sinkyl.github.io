---
// Subtle modular blocks SVG background
import { COLORS } from '../lib/theme';
---

<div class="blocks-bg" aria-hidden="true">
  <svg viewBox="0 0 1200 400" preserveAspectRatio="xMidYMax slice">
    <defs>
      <!-- Gradient for animated glow -->
      <linearGradient id="flowGradient1" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color={COLORS.blue} stop-opacity="0" />
        <stop offset="50%" stop-color={COLORS.blue} stop-opacity="0.8" />
        <stop offset="100%" stop-color={COLORS.blue} stop-opacity="0" />
      </linearGradient>
      <linearGradient id="flowGradient2" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color={COLORS.purple} stop-opacity="0" />
        <stop offset="50%" stop-color={COLORS.purple} stop-opacity="0.6" />
        <stop offset="100%" stop-color={COLORS.purple} stop-opacity="0" />
      </linearGradient>
    </defs>

    <!-- LEFT SIDE BLOCKS -->
    <g class="left-group">
      <!-- Connection lines left -->
      <line x1="80" y1="320" x2="120" y2="280" class="line solid" />
      <line x1="120" y1="280" x2="160" y2="300" class="line solid" />
      <line x1="40" y1="280" x2="80" y2="320" class="line solid" />
      <line x1="120" y1="280" x2="120" y2="220" class="line solid" />

      <!-- Animated flow lines left (sequential) -->
      <line x1="40" y1="280" x2="80" y2="320" class="line flow flow-l1" />
      <line x1="80" y1="320" x2="120" y2="280" class="line flow flow-l2" />
      <line x1="120" y1="280" x2="160" y2="300" class="line flow flow-l3" />
      <line x1="160" y1="300" x2="200" y2="340" class="line flow flow-l4" />

      <!-- Dashed connections left -->
      <line x1="50" y1="220" x2="120" y2="220" class="line dashed" />
      <line x1="160" y1="300" x2="200" y2="340" class="line dashed" />

      <!-- Blocks left -->
      <rect x="65" y="305" width="30" height="30" rx="6" class="block filled" />
      <rect x="105" y="265" width="30" height="30" rx="6" class="block filled" />
      <rect x="145" y="285" width="30" height="30" rx="6" class="block filled" />
      <rect x="105" y="205" width="30" height="30" rx="6" class="block filled" />
      <rect x="25" y="265" width="30" height="30" rx="6" class="block filled" />

      <!-- Floating blocks left -->
      <rect x="35" y="205" width="25" height="25" rx="5" class="block outline" />
      <rect x="185" y="325" width="25" height="25" rx="5" class="block outline" />

      <!-- Ports left -->
      <circle cx="95" cy="320" r="3" class="port" />
      <circle cx="120" cy="265" r="3" class="port" />
      <circle cx="145" cy="300" r="3" class="port" />
    </g>

    <!-- RIGHT SIDE BLOCKS -->
    <g class="right-group">
      <!-- Connection lines right -->
      <line x1="1020" y1="280" x2="1060" y2="320" class="line solid" />
      <line x1="980" y1="320" x2="1020" y2="280" class="line solid" />
      <line x1="1040" y1="220" x2="1020" y2="280" class="line solid" />
      <line x1="1060" y1="320" x2="1100" y2="300" class="line solid" />
      <line x1="1100" y1="300" x2="1140" y2="320" class="line solid" />

      <!-- Animated flow lines right (sequential) -->
      <line x1="1040" y1="220" x2="1020" y2="280" class="line flow flow-r1" />
      <line x1="1020" y1="280" x2="1060" y2="320" class="line flow flow-r2" />
      <line x1="1060" y1="320" x2="1100" y2="300" class="line flow flow-r3" />
      <line x1="1100" y1="300" x2="1140" y2="320" class="line flow flow-r4" />

      <!-- Dashed connections right -->
      <line x1="940" y1="260" x2="980" y2="320" class="line dashed" />
      <line x1="1080" y1="260" x2="1040" y2="220" class="line dashed" />
      <line x1="1000" y1="360" x2="1060" y2="320" class="line dashed" />
      <line x1="1160" y1="280" x2="1140" y2="320" class="line dashed" />

      <!-- Blocks right -->
      <rect x="1005" y="265" width="30" height="30" rx="6" class="block filled" />
      <rect x="1045" y="305" width="30" height="30" rx="6" class="block filled" />
      <rect x="965" y="305" width="30" height="30" rx="6" class="block filled" />
      <rect x="1025" y="205" width="30" height="30" rx="6" class="block filled" />
      <rect x="1085" y="285" width="30" height="30" rx="6" class="block filled" />
      <rect x="1125" y="305" width="30" height="30" rx="6" class="block filled" />

      <!-- Floating blocks right -->
      <rect x="925" y="245" width="25" height="25" rx="5" class="block outline" />
      <rect x="1065" y="245" width="25" height="25" rx="5" class="block outline" />
      <rect x="985" y="345" width="25" height="25" rx="5" class="block outline" />
      <rect x="1145" y="265" width="25" height="25" rx="5" class="block outline" />

      <!-- Ports right -->
      <circle cx="1020" cy="295" r="3" class="port" />
      <circle cx="1035" cy="280" r="3" class="port" />
      <circle cx="1060" cy="320" r="3" class="port" />
      <circle cx="980" cy="320" r="3" class="port" />
      <circle cx="1040" cy="235" r="3" class="port" />
      <circle cx="1100" cy="300" r="3" class="port" />
      <circle cx="1140" cy="320" r="3" class="port" />
    </g>

    <!-- Small accent dots -->
    <circle cx="10" cy="350" r="3" class="dot" />
    <circle cx="220" cy="300" r="2" class="dot" />
    <circle cx="900" cy="300" r="2" class="dot" />
    <circle cx="1190" cy="350" r="3" class="dot" />
  </svg>
</div>

<style>
  .blocks-bg {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    height: 300px;
    pointer-events: none;
    z-index: -1;
    opacity: 0.12;
  }

  .blocks-bg svg {
    width: 100%;
    height: 100%;
  }

  .line {
    stroke: var(--color-blue);
    stroke-width: 1.5;
  }

  .line.solid {
    opacity: 0.8;
  }

  .line.dashed {
    stroke-dasharray: 4 3;
    opacity: 0.5;
  }

  .line.flow {
    stroke: var(--color-blue);
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-dasharray: 0 100;
    opacity: 0;
  }

  /* Left side flow - travels through 4 segments */
  .line.flow-l1 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 0s; }
  .line.flow-l2 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 0.4s; }
  .line.flow-l3 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 0.8s; stroke: var(--color-purple); }
  .line.flow-l4 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 1.2s; stroke: var(--color-purple); }

  /* Right side flow - travels through 4 segments, offset timing */
  .line.flow-r1 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 3s; }
  .line.flow-r2 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 3.4s; }
  .line.flow-r3 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 3.8s; stroke: var(--color-purple); }
  .line.flow-r4 { animation: flowSegment 6s ease-in-out infinite; animation-delay: 4.2s; stroke: var(--color-purple); }

  @keyframes flowSegment {
    0%, 15% {
      stroke-dasharray: 0 100;
      opacity: 0;
    }
    20% {
      stroke-dasharray: 100 0;
      opacity: 0.7;
    }
    30%, 100% {
      stroke-dasharray: 100 0;
      opacity: 0;
    }
  }

  .block.filled {
    fill: color-mix(in srgb, var(--color-blue) 15%, transparent);
    stroke: var(--color-blue);
    stroke-width: 1.5;
  }

  .block.outline {
    fill: transparent;
    stroke: var(--color-purple);
    stroke-width: 1;
    stroke-dasharray: 3 2;
    opacity: 0.6;
  }

  .dot {
    fill: var(--color-purple);
    opacity: 0.4;
  }

  .port {
    fill: var(--color-blue);
    opacity: 0.7;
  }

  @media (max-width: 1200px) {
    .left-group {
      opacity: 0.5;
    }
  }

  @media (max-width: 768px) {
    .blocks-bg {
      height: 200px;
      opacity: 0.08;
    }

    .left-group {
      display: none;
    }
  }

  @media (max-width: 480px) {
    .blocks-bg {
      display: none;
    }
  }
</style>
