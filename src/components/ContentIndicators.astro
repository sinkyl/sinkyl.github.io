---
import type { ContentIndicators } from '../lib/contentIndicators';

interface Props {
  indicators?: ContentIndicators;
}

const { indicators } = Astro.props;
const hasAny = indicators && (indicators.hasImages || indicators.hasDiagrams || indicators.hasCode);
---

{hasAny && (
  <div class="content-indicators">
    {indicators.hasImages && (
      <span class="indicator" title="Contains images">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <circle cx="8.5" cy="8.5" r="1.5"/>
          <polyline points="21 15 16 10 5 21"/>
        </svg>
      </span>
    )}
    {indicators.hasDiagrams && (
      <span class="indicator" title="Contains diagrams">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 3h6v6H3zM15 3h6v6h-6zM9 15h6v6H9z"/>
          <path d="M6 9v3h3M18 9v3h-3M12 9v6"/>
        </svg>
      </span>
    )}
    {indicators.hasCode && (
      <span class="indicator" title="Contains code">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="16 18 22 12 16 6"/>
          <polyline points="8 6 2 12 8 18"/>
        </svg>
      </span>
    )}
  </div>
)}

<style>
  .content-indicators {
    display: flex;
    gap: 0.4rem;
    margin-left: auto;
  }

  .indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    color: var(--text-muted);
    opacity: var(--opacity-muted);
    transition: opacity 0.2s, color 0.2s;
  }

  .indicator svg {
    width: 17px;
    height: 17px;
  }

  /* Touch devices can't hover, so show color by default */
  @media (hover: none) {
    .indicator {
      opacity: var(--opacity-medium);
      color: var(--indicator-color, var(--text-muted));
    }
  }
</style>

<script>
  import { getRandomAccentColor } from '../lib/randomColor';

  // Apply random color to indicators on touch devices
  if (window.matchMedia('(hover: none)').matches) {
    const color = getRandomAccentColor();
    document.querySelectorAll('.content-indicators').forEach((container) => {
      (container as HTMLElement).style.setProperty('--indicator-color', color);
    });
  }
</script>
