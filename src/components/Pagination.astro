---
interface Props {
  totalPages: number;
  postsPerPage: number;
  containerId: string;
}

const { totalPages, postsPerPage, containerId } = Astro.props;
---

<!-- Always inject config so posts become visible -->
<script define:vars={{ totalPages, postsPerPage, containerId }}>
  window.__paginationConfig = window.__paginationConfig || {};
  window.__paginationConfig[containerId] = { totalPages, postsPerPage };
</script>

{totalPages > 1 && (
  <nav class="pagination" id={`pagination-${containerId}`}>
    <button class="page-btn prev" id={`prev-btn-${containerId}`} disabled>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>
    <input
      type="text"
      inputmode="numeric"
      class="page-indicator"
      id={`page-indicator-${containerId}`}
      value={`1 . . ${totalPages}`}
      readonly
    />
    <button class="page-btn next" id={`next-btn-${containerId}`}>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 18l6-6-6-6"/>
      </svg>
    </button>
  </nav>
)}

<style>
  .pagination {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 2rem;
    padding: 1rem 0;
  }

  /* Floating state */
  .pagination.floating {
    position: fixed;
    bottom: 1.5rem;
    left: 50%;
    transform: translateX(-50%);
    margin: 0;
    padding: 0.5rem 0.75rem;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    z-index: 50;
  }

  .page-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--touch-target);
    height: var(--touch-target);
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: border-color 0.2s, background 0.2s, opacity 0.2s;
  }

  .page-btn:hover:not(:disabled) {
    border-color: var(--accent);
    background: var(--bg-secondary);
  }

  .page-btn:disabled {
    opacity: var(--opacity-disabled);
    cursor: not-allowed;
  }

  .page-btn svg {
    width: var(--icon-size);
    height: var(--icon-size);
    color: var(--text);
  }

  .page-indicator {
    font-size: var(--font-md-lg);
    color: var(--text-muted);
    width: 65px;
    text-align: center;
    background: transparent;
    border: 1px solid transparent;
    border-radius: var(--radius-sm);
    padding: 0.25rem;
    cursor: pointer;
    transition: border-color 0.2s, background 0.2s;
  }

  .page-indicator:hover {
    border-color: var(--border);
  }

  .page-indicator:focus {
    outline: none;
    border-color: var(--accent);
    background: var(--bg-card);
    cursor: text;
  }

  .pagination.floating .page-indicator:focus {
    background: var(--bg-secondary);
  }

  /* Mobile: compact pagination */
  @media (max-width: 600px) {
    .page-btn {
      width: 32px;
      height: 32px;
    }

    .page-btn svg {
      width: 16px;
      height: 16px;
    }

    .page-indicator {
      font-size: 16px;
      width: 55px;
    }

    .pagination.floating {
      padding: 0.4rem 0.6rem;
      gap: 0.4rem;
    }
  }
</style>
